-- === Part 1: Table Creation (Problem Statement 1-4) ===
[cite_start]-- Creating the Department table with a Unique constraint [cite: 3, 6, 7, 8, 10, 11]
CREATE TABLE Department(
    dept_no int,
    dept_name varchar(15),
    bldg_name varchar(15),
    UNIQUE(dept_name)
);

[cite_start]-- Creating the Instructor table with Not Null and Primary Key constraints [cite: 26]
CREATE TABLE instructor(
    ins_id int,
    ins_name varchar(15) NOT NULL,
    dept_no int,
    salary int,
    mob_no int,
    PRIMARY KEY(ins_id)
);

[cite_start]-- Creating the Course table with a Primary Key constraint [cite: 43]
CREATE TABLE course(
    course_id int,
    title varchar(15),
    dept_no int,
    credits int,
    PRIMARY KEY(course_id)
);

[cite_start]-- Creating the Teaches table with Foreign Key constraints [cite: 64, 65, 66, 67]
CREATE TABLE teachers (
    teacher_id int,
    course_id int,
    semester int,
    year year,
    FOREIGN KEY (teacher_id) REFERENCES instructor(ins_id),
    FOREIGN KEY (course_id) REFERENCES course(course_id)
);

-- === Part 2: Data Insertion (Implied from PDF for Queries) ===
[cite_start]-- This data is shown in your 'SELECT' query results [cite: 151, 154, 157, 197, 199, 202, 374-382]
INSERT INTO Department (dept_no, dept_name, bldg_name) VALUES 
(1, 'comp', 'A'), 
(2, 'mech', 'B'), 
(3, 'IT', 'C');

INSERT INTO instructor (ins_id, ins_name, dept_no, salary, mob_no) VALUES 
(1, 'A', 1, 10000, 10020), 
(2, 'B', 2, 12000, 11220), 
(3, 'C', 3, 10500, 11020);

[cite_start]-- This data is needed for Query 20 to work [cite: 661-663]
INSERT INTO course (course_id, title, dept_no, credits) VALUES
(101, 'DBMS', 1, 4);

INSERT INTO teachers (teacher_id, course_id, semester, year) VALUES
(1, 101, 2, 2023);


-- === Part 3: Assignment Queries (Queries 1-20) ===

[cite_start]-- 1. Add the primary key in department table. [cite: 86]
ALTER TABLE Department ADD PRIMARY KEY(dept_no);

[cite_start]-- 2. Add the foreign key in instructor table. [cite: 113]
ALTER TABLE instructor ADD FOREIGN KEY(dept_no) REFERENCES Department(dept_no);

[cite_start]-- 3. Modify the table department by adding a column budget. [cite: 140]
ALTER TABLE Department ADD COLUMN budget int;
SELECT * FROM Department; [cite_start]-- To verify Query 3 [cite: 143]

[cite_start]-- 4. Create unique index on mobile number of instructor table. [cite: 167]
CREATE UNIQUE INDEX sr ON instructor(mob_no);

[cite_start]-- 5. Create a view of instructor relation except the salary field. [cite: 187]
CREATE VIEW inst_view AS
SELECT ins_id, ins_name, dept_no, mob_no
FROM instructor;
SELECT * FROM inst_view; [cite_start]-- To verify Query 5 [cite: 189]

-- 6. Insert record into instructor table using newly created viewname.
[cite_start]-- First, add the department the new instructor will belong to [cite: 209]
INSERT INTO Department VALUES (4, "Elect", "D", null);
SELECT * FROM Department; [cite_start]-- To verify new department [cite: 211]

[cite_start]-- Now, insert the new instructor *through the view* [cite: 254]
INSERT INTO inst_view (ins_id, ins_name, dept_no, mob_no) VALUES (4, "D", 4, 12000);
SELECT * FROM inst_view; [cite_start]-- To verify the insert [cite: 256]

[cite_start]-- 7. Update the department number of particular instructor using update view. [cite: 275]
UPDATE inst_view SET dept_no = 2 WHERE ins_id = 4;
SELECT * FROM inst_view; [cite_start]-- To verify the update [cite: 278]

[cite_start]-- 8. Delete record of particular instructor from instructor table using newly created viewname. [cite: 295]
DELETE FROM inst_view WHERE ins_id = 4;
SELECT * FROM inst_view; [cite_start]-- To verify the delete [cite: 297]

[cite_start]-- 9. Delete the last view. [cite: 312]
DROP VIEW inst_view;

[cite_start]-- 10. Remove the Budget from department table. [cite: 317]
ALTER TABLE Department DROP COLUMN budget;
SELECT * FROM Department; [cite_start]-- To verify the drop [cite: 320]

[cite_start]-- 11. Increase the size of the title field of course relation. [cite: 335]
ALTER TABLE course MODIFY title varchar(20);

[cite_start]-- 12. Create a view by showing a instructor name with a department name and its salary. [cite: 366]
CREATE VIEW newview1 AS
SELECT ins_name, dept_name, salary
FROM instructor, Department
WHERE instructor.dept_no = Department.dept_no;
SELECT * FROM newview1; [cite_start]-- To verify the view [cite: 368]

[cite_start]-- 13. Update salary of particular instructor using update view. [cite: 387]
UPDATE newview1 SET salary = 11000 WHERE ins_name = "C";
SELECT * FROM instructor; [cite_start]-- To verify the update on the base table [cite: 390]

[cite_start]-- 14. Delete the index from the instructor table. [cite: 416]
ALTER TABLE instructor DROP INDEX sr;

[cite_start]-- 15. Rename the course table to another table name. [cite: 447]
RENAME TABLE course TO coursetable;

[cite_start]-- 16. Create a view by showing a instructor name and title of course he teaches. [cite: 479, 480]
[cite_start]-- Note: This will be empty, as shown in your solution [cite: 483]
CREATE VIEW newview2 AS
SELECT ins_name, title
FROM instructor, coursetable
WHERE instructor.dept_no = coursetable.dept_no;
SELECT * FROM newview2; [cite_start]-- To verify the view [cite: 482]

-- 17. Delete the primary key from the department table.
[cite_start]-- First, find and drop the foreign key in 'instructor' that depends on it [cite: 485, 498]
ALTER TABLE instructor DROP FOREIGN KEY instructor_ibfk_1;
[cite_start]-- Now, you can safely drop the primary key [cite: 553]
ALTER TABLE Department DROP PRIMARY KEY;

-- 18. Create the table student having field student id...
[cite_start]-- First, re-add the primary key to Department so the new FK can reference it [cite: 582]
ALTER TABLE Department ADD PRIMARY KEY(dept_no);
[cite_start]-- Create the Student table with auto_increment [cite: 585]
CREATE TABLE Student(
    stud_id int AUTO_INCREMENT,
    stud_name varchar(10),
    dept_no int,
    DOB date,
    FOREIGN KEY(dept_no) REFERENCES Department(dept_no),
    PRIMARY KEY(stud_id)
);

-- 19. Change the sequence of your auto increment field.
[cite_start]-- Insert sample data into Student [cite: 611, 614, 616]
INSERT INTO Student (stud_name, dept_no, DOB) VALUES 
('AB', 1, '1997-04-12'), 
('CD', 3, '1996-06-12'), 
('EF', 2, '1998-09-25');
SELECT * FROM Student; [cite_start]-- To see current data [cite: 603]

[cite_start]-- Change the next auto_increment value [cite: 622]
ALTER TABLE Student AUTO_INCREMENT = 5;

[cite_start]-- Insert a new record to see the sequence change [cite: 643, 644]
INSERT INTO Student (stud_name, dept_no, DOB) VALUES 
('GH', 2, '1995-09-25');
SELECT * FROM Student; [cite_start]-- To verify the new ID [cite: 625]

[cite_start]-- 20. Create the view of computer department teachers name... [cite: 651]
-- (Data for this was inserted in Part 2)
CREATE VIEW new1 AS
SELECT dept_name, semester, ins_name
FROM Department, teachers, instructor
WHERE teachers.semester = 2
  AND Department.dept_name = "comp"
  AND instructor.ins_id = teachers.teacher_id
  AND instructor.dept_no = Department.dept_no;

SELECT * FROM new1; [cite_start]-- To verify the final view [cite: 653]