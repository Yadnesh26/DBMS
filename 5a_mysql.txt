-- === Part 1: Table Creation ===
CREATE TABLE studmarks (
    Name VARCHAR(15), 
    TotalMarks INT
);
CREATE TABLE result (
    Roll_No TINYINT, 
    Name VARCHAR(15), 
    Class VARCHAR(25)
);

-- === Part 2: Stored Procedure (procedure_grade) ===
DELIMITER $
CREATE PROCEDURE proc_grade(
    IN rollno TINYINT, 
    IN name VARCHAR(15), 
    IN marks INT
)
BEGIN
    DECLARE class VARCHAR(25);
    IF marks >= 990 AND marks <= 1500 THEN 
        SET class = "Distinction";
    ELSEIF marks <= 989 AND marks >= 900 THEN 
        SET class = "First Class";
    ELSEIF marks <= 899 AND marks >= 825 THEN 
        SET class = "Second Class";
    ELSEIF marks <= 824 AND marks >= 700 THEN 
        SET class = "Pass";
    ELSE 
        SET class = "Fail";
    END IF;
    
    INSERT INTO studmarks VALUES(name, marks);
    INSERT INTO result VALUES(rollno, name, class);
END $
DELIMITER ; -- (Resetting delimiter)

-- === Part 3: Calling the Procedure ===
CALL proc_grade(1, "Aryan", 850);
CALL proc_grade(2, "Peter", 1000);
CALL proc_grade(3, "Smith", 834);
CALL proc_grade(4, "Carol", 750);
CALL proc_grade(5, "Bob", 950);
CALL proc_grade(6, "Sam", 650);

-- === Part 4: Verifying Procedure Results ===
SELECT * FROM result;
SELECT * FROM studmarks;

-- === Part 5: Stored Function (totalStudents) ===
DELIMITER $
CREATE FUNCTION tot_stud(classname VARCHAR(25)) 
RETURNS INT
READS SQL DATA -- Added hint for good practice
BEGIN
    DECLARE total INT DEFAULT 0; -- Set default
    SELECT COUNT(*) INTO total 
    FROM result 
    WHERE Class = classname;
    RETURN total;
END $
DELIMITER ; -- (Fixed typo: DELIMITTER -> DELIMITER)

-- === Part 6: Calling the Function ===
SELECT tot_stud("Second Class");
SELECT tot_stud("Pass");